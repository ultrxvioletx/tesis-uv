#include <stdio.h>
#include <math.h>
#include <complex.h>
#include <gsl/gsl_errno.h>
#include "hdf5.h"
#define FILENAME "dset.h5"

#include <gsl/gsl_matrix.h>
#include <gsl/gsl_odeiv2.h>

int func (double t, const double y[], double f[], void *params) {
    f[0] = 1.5*y[16] + 1.0*y[18] + 1.5*y[2] + 0.5*y[33] + 0.5*y[36] - 0.5*y[5] + 0.5*y[65] + 0.5*y[72] - 0.5*y[9];
    f[1] = 1.5*y[17] + 1.0*y[19] - 0.5*y[32] + 0.5*y[37] + 1.5*y[3] + 0.5*y[4] - 0.5*y[64] + 0.5*y[73] + 0.5*y[8];
    f[2] = -1.5*y[0] - 0.5*y[11] + 1.5*y[18] - 0.5*y[2] + 0.5*y[35] + 0.5*y[38] + 1.0*y[5] + 0.5*y[67] + 0.5*y[74] - 0.5*y[7] + 1.0*y[9];
    f[3] = 0.5*y[10] + 1.5*y[19] - 1.5*y[1] - 0.5*y[34] + 0.5*y[39] - 0.5*y[3] - 1.0*y[4] - 0.5*y[66] + 0.5*y[6] + 0.5*y[75] - 1.0*y[8];
    f[4] = -0.5*y[13] - 0.5*y[1] + 1.5*y[20] + 1.0*y[22] + 0.5*y[37] + 1.0*y[3] - 0.25*y[4] + 0.5*y[69] + 1.5*y[6] + 0.5*y[76] + 0.2*y[9];
    f[5] = 0.5*y[0] + 0.5*y[12] + 1.5*y[21] + 1.0*y[23] - 1.0*y[2] - 0.5*y[36] - 0.25*y[5] - 0.5*y[68] + 0.5*y[77] + 1.5*y[7] - 0.2*y[8];
    f[6] = 0.2*y[11] + 1.0*y[13] - 0.5*y[15] + 1.5*y[22] + 0.5*y[39] - 0.5*y[3] - 1.5*y[4] - 0.75*y[6] + 0.5*y[71] + 0.5*y[78];
    f[7] = -0.2*y[10] - 1.0*y[12] + 0.5*y[14] + 1.5*y[23] + 0.5*y[2] - 0.5*y[38] - 1.5*y[5] - 0.5*y[70] + 0.5*y[79] - 0.75*y[7];
    f[8] = 1.5*y[10] - 0.5*y[13] - 0.5*y[1] + 1.5*y[24] + 1.0*y[26] + 1.0*y[3] + 0.5*y[41] + 0.5*y[44] + 0.2*y[5] + 0.5*y[73] - 0.25*y[8];
    f[9] = 0.5*y[0] + 1.5*y[11] + 0.5*y[12] + 1.5*y[25] + 1.0*y[27] - 1.0*y[2] - 0.5*y[40] + 0.5*y[45] - 0.2*y[4] - 0.5*y[72] - 0.25*y[9];
    f[10] = -0.75*y[10] + 1.0*y[13] - 0.5*y[15] + 1.5*y[26] - 0.5*y[3] + 0.5*y[43] + 0.5*y[46] + 0.5*y[75] + 0.2*y[7] - 1.5*y[8];
    f[11] = -0.75*y[11] - 1.0*y[12] + 0.5*y[14] + 1.5*y[27] + 0.5*y[2] - 0.5*y[42] + 0.5*y[47] - 0.2*y[6] - 0.5*y[74] - 1.5*y[9];
    f[12] = 1.0*y[11] - 0.5*y[12] + 1.5*y[14] + 1.5*y[28] + 1.0*y[30] + 0.5*y[45] - 0.5*y[5] + 0.5*y[77] + 1.0*y[7] - 0.5*y[9];
    f[13] = -1.0*y[10] - 0.5*y[13] + 1.5*y[15] + 1.5*y[29] + 1.0*y[31] - 0.5*y[44] + 0.5*y[4] - 1.0*y[6] - 0.5*y[76] + 0.5*y[8];
    f[14] = -0.5*y[11] - 1.5*y[12] - 1.0*y[14] + 1.5*y[30] + 0.5*y[47] + 0.5*y[79] - 0.5*y[7];
    f[15] = 0.5*y[10] - 1.5*y[13] - 1.0*y[15] + 1.5*y[31] - 0.5*y[46] + 0.5*y[6] - 0.5*y[78];
    f[16] = -1.5*y[0] - 0.5*y[16] + 1.5*y[18] - 0.5*y[21] - 0.5*y[25] - 1.0*y[33] + 0.5*y[49] + 0.5*y[52] - 1.0*y[65] + 0.5*y[81] + 0.5*y[88];
    f[17] = -0.5*y[17] + 1.5*y[19] - 1.5*y[1] + 0.5*y[20] + 0.5*y[24] + 1.0*y[32] - 0.5*y[48] + 0.5*y[53] + 1.0*y[64] - 0.5*y[80] + 0.5*y[89];
    f[18] = -1.5*y[16] - 1.0*y[18] + 1.0*y[21] - 0.5*y[23] + 1.0*y[25] - 0.5*y[27] - 1.5*y[2] - 1.0*y[35] + 0.5*y[51] + 0.5*y[54] - 1.0*y[67] + 0.5*y[83] + 0.5*y[90];
    f[19] = -1.5*y[17] - 1.0*y[19] - 1.0*y[20] + 0.5*y[22] - 1.0*y[24] + 0.5*y[26] + 1.0*y[34] - 1.5*y[3] - 0.5*y[50] + 0.5*y[55] + 1.0*y[66] - 0.5*y[82] + 0.5*y[91];
    f[20] = -0.5*y[17] + 1.0*y[19] - 0.75*y[20] + 1.5*y[22] + 0.2*y[25] - 0.5*y[29] - 1.0*y[37] - 1.5*y[4] + 0.5*y[53] - 1.0*y[69] + 0.5*y[85] + 0.5*y[92];
    f[21] = 0.5*y[16] - 1.0*y[18] - 0.75*y[21] + 1.5*y[23] - 0.2*y[24] + 0.5*y[28] + 1.0*y[36] - 0.5*y[52] - 1.5*y[5] + 1.0*y[68] - 0.5*y[84] + 0.5*y[93];
    f[22] = -0.5*y[19] - 1.5*y[20] - 1.25*y[22] + 0.2*y[27] + 1.0*y[29] - 0.5*y[31] - 1.0*y[39] + 0.5*y[55] - 1.5*y[6] - 1.0*y[71] + 0.5*y[87] + 0.5*y[94];
    f[23] = 0.5*y[18] - 1.5*y[21] - 1.25*y[23] - 0.2*y[26] - 1.0*y[28] + 0.5*y[30] + 1.0*y[38] - 0.5*y[54] + 1.0*y[70] - 1.5*y[7] - 0.5*y[86] + 0.5*y[95];
    f[24] = -0.5*y[17] + 1.0*y[19] + 0.2*y[21] - 0.75*y[24] + 1.5*y[26] - 0.5*y[29] - 1.0*y[41] + 0.5*y[57] + 0.5*y[60] - 1.0*y[73] + 0.5*y[89] - 1.5*y[8];
    f[25] = 0.5*y[16] - 1.0*y[18] - 0.2*y[20] - 0.75*y[25] + 1.5*y[27] + 0.5*y[28] + 1.0*y[40] - 0.5*y[56] + 0.5*y[61] + 1.0*y[72] - 0.5*y[88] - 1.5*y[9];
    f[26] = -1.5*y[10] - 0.5*y[19] + 0.2*y[23] - 1.5*y[24] - 1.25*y[26] + 1.0*y[29] - 0.5*y[31] - 1.0*y[43] + 0.5*y[59] + 0.5*y[62] - 1.0*y[75] + 0.5*y[91];
    f[27] = -1.5*y[11] + 0.5*y[18] - 0.2*y[22] - 1.5*y[25] - 1.25*y[27] - 1.0*y[28] + 0.5*y[30] + 1.0*y[42] - 0.5*y[58] + 0.5*y[63] + 1.0*y[74] - 0.5*y[90];
    f[28] = -1.5*y[12] - 0.5*y[21] + 1.0*y[23] - 0.5*y[25] + 1.0*y[27] - 1.0*y[28] + 1.5*y[30] - 1.0*y[45] + 0.5*y[61] - 1.0*y[77] + 0.5*y[93];
    f[29] = -1.5*y[13] + 0.5*y[20] - 1.0*y[22] + 0.5*y[24] - 1.0*y[26] - 1.0*y[29] + 1.5*y[31] + 1.0*y[44] - 0.5*y[60] + 1.0*y[76] - 0.5*y[92];
    f[30] = -1.5*y[14] - 0.5*y[23] - 0.5*y[27] - 1.5*y[28] - 1.5*y[30] - 1.0*y[47] + 0.5*y[63] - 1.0*y[79] + 0.5*y[95];
    f[31] = -1.5*y[15] + 0.5*y[22] + 0.5*y[26] - 1.5*y[29] - 1.5*y[31] + 1.0*y[46] - 0.5*y[62] + 1.0*y[78] - 0.5*y[94];
    f[32] = 0.5*y[104] - 1.0*y[17] + 0.5*y[1] - 0.25*y[32] + 1.5*y[34] - 0.5*y[37] - 0.5*y[41] + 1.5*y[48] + 1.0*y[50] - 0.2*y[65] + 0.5*y[97];
    f[33] = -0.5*y[0] + 0.5*y[105] + 1.0*y[16] - 0.25*y[33] + 1.5*y[35] + 0.5*y[36] + 0.5*y[40] + 1.5*y[49] + 1.0*y[51] + 0.2*y[64] - 0.5*y[96];
    f[34] = 0.5*y[106] - 1.0*y[19] - 1.5*y[32] - 0.75*y[34] + 1.0*y[37] - 0.5*y[39] + 0.5*y[3] + 1.0*y[41] - 0.5*y[43] + 1.5*y[50] - 0.2*y[67] + 0.5*y[99];
    f[35] = 0.5*y[107] + 1.0*y[18] - 0.5*y[2] - 1.5*y[33] - 0.75*y[35] - 1.0*y[36] + 0.5*y[38] - 1.0*y[40] + 0.5*y[42] + 1.5*y[51] + 0.2*y[66] - 0.5*y[98];
    f[36] = 0.5*y[101] + 0.5*y[108] - 1.0*y[21] - 0.5*y[33] + 1.0*y[35] - 0.5*y[36] + 1.5*y[38] + 0.2*y[41] - 0.5*y[45] + 1.5*y[52] + 1.0*y[54] + 0.5*y[5] - 0.2*y[69];
    f[37] = -0.5*y[100] + 0.5*y[109] + 1.0*y[20] + 0.5*y[32] - 1.0*y[34] - 0.5*y[37] + 1.5*y[39] - 0.2*y[40] + 0.5*y[44] - 0.5*y[4] + 1.5*y[53] + 1.0*y[55] + 0.2*y[68];
    f[38] = 0.5*y[103] + 0.5*y[110] - 1.0*y[23] - 0.5*y[35] - 1.5*y[36] - 1.0*y[38] + 0.2*y[43] + 1.0*y[45] - 0.5*y[47] + 1.5*y[54] - 0.2*y[71] + 0.5*y[7];
    f[39] = -0.5*y[102] + 0.5*y[111] + 1.0*y[22] + 0.5*y[34] - 1.5*y[37] - 1.0*y[39] - 0.2*y[42] - 1.0*y[44] + 0.5*y[46] + 1.5*y[55] - 0.5*y[6] + 0.2*y[70];
    f[40] = 0.5*y[105] - 1.0*y[25] - 0.5*y[33] + 1.0*y[35] + 0.2*y[37] - 0.5*y[40] + 1.5*y[42] - 0.5*y[45] + 1.5*y[56] + 1.0*y[58] - 0.2*y[73] + 0.5*y[9];
    f[41] = -0.5*y[104] + 1.0*y[24] + 0.5*y[32] - 1.0*y[34] - 0.2*y[36] - 0.5*y[41] + 1.5*y[43] + 0.5*y[44] + 1.5*y[57] + 1.0*y[59] + 0.2*y[72] - 0.5*y[8];
    f[42] = 0.5*y[107] + 0.5*y[11] - 1.0*y[27] - 0.5*y[35] + 0.2*y[39] - 1.5*y[40] - 1.0*y[42] + 1.0*y[45] - 0.5*y[47] + 1.5*y[58] - 0.2*y[75];
    f[43] = -0.5*y[106] - 0.5*y[10] + 1.0*y[26] + 0.5*y[34] - 0.2*y[38] - 1.5*y[41] - 1.0*y[43] - 1.0*y[44] + 0.5*y[46] + 1.5*y[59] + 0.2*y[74];
    f[44] = 0.5*y[109] + 0.5*y[13] - 1.0*y[29] - 0.5*y[37] + 1.0*y[39] - 0.5*y[41] + 1.0*y[43] - 0.75*y[44] + 1.5*y[46] + 1.5*y[60] + 1.0*y[62] - 0.2*y[77];
    f[45] = -0.5*y[108] - 0.5*y[12] + 1.0*y[28] + 0.5*y[36] - 1.0*y[38] + 0.5*y[40] - 1.0*y[42] - 0.75*y[45] + 1.5*y[47] + 1.5*y[61] + 1.0*y[63] + 0.2*y[76];
    f[46] = 0.5*y[111] + 0.5*y[15] - 1.0*y[31] - 0.5*y[39] - 0.5*y[43] - 1.5*y[44] - 1.25*y[46] + 1.5*y[62] - 0.2*y[79];
    f[47] = -0.5*y[110] - 0.5*y[14] + 1.0*y[30] + 0.5*y[38] + 0.5*y[42] - 1.5*y[45] - 1.25*y[47] + 1.5*y[63] + 0.2*y[78];
    f[48] = 0.5*y[113] + 0.5*y[120] + 0.5*y[17] - 1.5*y[32] - 0.75*y[48] + 1.5*y[50] - 0.5*y[53] - 0.5*y[57] - 0.2*y[81] - 1.0*y[97];
    f[49] = -0.5*y[112] + 0.5*y[121] - 0.5*y[16] - 1.5*y[33] - 0.75*y[49] + 1.5*y[51] + 0.5*y[52] + 0.5*y[56] + 0.2*y[80] + 1.0*y[96];
    f[50] = 0.5*y[115] + 0.5*y[122] + 0.5*y[19] - 1.5*y[34] - 1.5*y[48] - 1.25*y[50] + 1.0*y[53] - 0.5*y[55] + 1.0*y[57] - 0.5*y[59] - 0.2*y[83] - 1.0*y[99];
    f[51] = -0.5*y[114] + 0.5*y[123] - 0.5*y[18] - 1.5*y[35] - 1.5*y[49] - 1.25*y[51] - 1.0*y[52] + 0.5*y[54] - 1.0*y[56] + 0.5*y[58] + 0.2*y[82] + 1.0*y[98];
    f[52] = -1.0*y[101] + 0.5*y[117] + 0.5*y[124] + 0.5*y[21] - 1.5*y[36] - 0.5*y[49] + 1.0*y[51] - 1.0*y[52] + 1.5*y[54] + 0.2*y[57] - 0.5*y[61] - 0.2*y[85];
    f[53] = 1.0*y[100] - 0.5*y[116] + 0.5*y[125] - 0.5*y[20] - 1.5*y[37] + 0.5*y[48] - 1.0*y[50] - 1.0*y[53] + 1.5*y[55] - 0.2*y[56] + 0.5*y[60] + 0.2*y[84];
    f[54] = -1.0*y[103] + 0.5*y[119] + 0.5*y[126] + 0.5*y[23] - 1.5*y[38] - 0.5*y[51] - 1.5*y[52] - 1.5*y[54] + 0.2*y[59] + 1.0*y[61] - 0.5*y[63] - 0.2*y[87];
    f[55] = 1.0*y[102] - 0.5*y[118] + 0.5*y[127] - 0.5*y[22] - 1.5*y[39] + 0.5*y[50] - 1.5*y[53] - 1.5*y[55] - 0.2*y[58] - 1.0*y[60] + 0.5*y[62] + 0.2*y[86];
    f[56] = -1.0*y[105] + 0.5*y[121] + 0.5*y[25] - 1.5*y[40] - 0.5*y[49] + 1.0*y[51] + 0.2*y[53] - 1.0*y[56] + 1.5*y[58] - 0.5*y[61] - 0.2*y[89];
    f[57] = 1.0*y[104] - 0.5*y[120] - 0.5*y[24] - 1.5*y[41] + 0.5*y[48] - 1.0*y[50] - 0.2*y[52] - 1.0*y[57] + 1.5*y[59] + 0.5*y[60] + 0.2*y[88];
    f[58] = -1.0*y[107] + 0.5*y[123] + 0.5*y[27] - 1.5*y[42] - 0.5*y[51] + 0.2*y[55] - 1.5*y[56] - 1.5*y[58] + 1.0*y[61] - 0.5*y[63] - 0.2*y[91];
    f[59] = 1.0*y[106] - 0.5*y[122] - 0.5*y[26] - 1.5*y[43] + 0.5*y[50] - 0.2*y[54] - 1.5*y[57] - 1.5*y[59] - 1.0*y[60] + 0.5*y[62] + 0.2*y[90];
    f[60] = -1.0*y[109] + 0.5*y[125] + 0.5*y[29] - 1.5*y[44] - 0.5*y[53] + 1.0*y[55] - 0.5*y[57] + 1.0*y[59] - 1.25*y[60] + 1.5*y[62] - 0.2*y[93];
    f[61] = 1.0*y[108] - 0.5*y[124] - 0.5*y[28] - 1.5*y[45] + 0.5*y[52] - 1.0*y[54] + 0.5*y[56] - 1.0*y[58] - 1.25*y[61] + 1.5*y[63] + 0.2*y[92];
    f[62] = -1.0*y[111] + 0.5*y[127] + 0.5*y[31] - 1.5*y[46] - 0.5*y[55] - 0.5*y[59] - 1.5*y[60] - 1.75*y[62] - 0.2*y[95];
    f[63] = 1.0*y[110] - 0.5*y[126] - 0.5*y[30] - 1.5*y[47] + 0.5*y[54] + 0.5*y[58] - 1.5*y[61] - 1.75*y[63] + 0.2*y[94];
    f[64] = 0.5*y[100] - 1.0*y[17] + 0.5*y[1] - 0.2*y[33] - 0.25*y[64] + 1.5*y[66] - 0.5*y[69] - 0.5*y[73] + 1.5*y[80] + 1.0*y[82] + 0.5*y[97];
    f[65] = -0.5*y[0] + 0.5*y[101] + 1.0*y[16] + 0.2*y[32] - 0.25*y[65] + 1.5*y[67] + 0.5*y[68] + 0.5*y[72] + 1.5*y[81] + 1.0*y[83] - 0.5*y[96];
    f[66] = 0.5*y[102] - 1.0*y[19] - 0.2*y[35] + 0.5*y[3] - 1.5*y[64] - 0.75*y[66] + 1.0*y[69] - 0.5*y[71] + 1.0*y[73] - 0.5*y[75] + 1.5*y[82] + 0.5*y[99];
    f[67] = 0.5*y[103] + 1.0*y[18] - 0.5*y[2] + 0.2*y[34] - 1.5*y[65] - 0.75*y[67] - 1.0*y[68] + 0.5*y[70] - 1.0*y[72] + 0.5*y[74] + 1.5*y[83] - 0.5*y[98];
    f[68] = 0.5*y[101] - 1.0*y[21] - 0.2*y[37] + 0.5*y[5] - 0.5*y[65] + 1.0*y[67] - 0.5*y[68] + 1.5*y[70] + 0.2*y[73] - 0.5*y[77] + 1.5*y[84] + 1.0*y[86];
    f[69] = -0.5*y[100] + 1.0*y[20] + 0.2*y[36] - 0.5*y[4] + 0.5*y[64] - 1.0*y[66] - 0.5*y[69] + 1.5*y[71] - 0.2*y[72] + 0.5*y[76] + 1.5*y[85] + 1.0*y[87];
    f[70] = 0.5*y[103] - 1.0*y[23] - 0.2*y[39] - 0.5*y[67] - 1.5*y[68] - 1.0*y[70] + 0.2*y[75] + 1.0*y[77] - 0.5*y[79] + 0.5*y[7] + 1.5*y[86];
    f[71] = -0.5*y[102] + 1.0*y[22] + 0.2*y[38] + 0.5*y[66] - 1.5*y[69] - 0.5*y[6] - 1.0*y[71] - 0.2*y[74] - 1.0*y[76] + 0.5*y[78] + 1.5*y[87];
    f[72] = 0.5*y[105] + 0.5*y[108] - 1.0*y[25] - 0.2*y[41] - 0.5*y[65] + 1.0*y[67] + 0.2*y[69] - 0.5*y[72] + 1.5*y[74] - 0.5*y[77] + 1.5*y[88] + 1.0*y[90] + 0.5*y[9];
    f[73] = -0.5*y[104] + 0.5*y[109] + 1.0*y[24] + 0.2*y[40] + 0.5*y[64] - 1.0*y[66] - 0.2*y[68] - 0.5*y[73] + 1.5*y[75] + 0.5*y[76] + 1.5*y[89] - 0.5*y[8] + 1.0*y[91];
    f[74] = 0.5*y[107] + 0.5*y[110] + 0.5*y[11] - 1.0*y[27] - 0.2*y[43] - 0.5*y[67] + 0.2*y[71] - 1.5*y[72] - 1.0*y[74] + 1.0*y[77] - 0.5*y[79] + 1.5*y[90];
    f[75] = -0.5*y[106] - 0.5*y[10] + 0.5*y[111] + 1.0*y[26] + 0.2*y[42] + 0.5*y[66] - 0.2*y[70] - 1.5*y[73] - 1.0*y[75] - 1.0*y[76] + 0.5*y[78] + 1.5*y[91];
    f[76] = 0.5*y[109] + 0.5*y[13] - 1.0*y[29] - 0.2*y[45] - 0.5*y[69] + 1.0*y[71] - 0.5*y[73] + 1.0*y[75] - 0.75*y[76] + 1.5*y[78] + 1.5*y[92] + 1.0*y[94];
    f[77] = -0.5*y[108] - 0.5*y[12] + 1.0*y[28] + 0.2*y[44] + 0.5*y[68] - 1.0*y[70] + 0.5*y[72] - 1.0*y[74] - 0.75*y[77] + 1.5*y[79] + 1.5*y[93] + 1.0*y[95];
    f[78] = 0.5*y[111] + 0.5*y[15] - 1.0*y[31] - 0.2*y[47] - 0.5*y[71] - 0.5*y[75] - 1.5*y[76] - 1.25*y[78] + 1.5*y[94];
    f[79] = -0.5*y[110] - 0.5*y[14] + 1.0*y[30] + 0.2*y[46] + 0.5*y[70] + 0.5*y[74] - 1.5*y[77] - 1.25*y[79] + 1.5*y[95];
    f[80] = 0.5*y[113] + 0.5*y[116] + 0.5*y[17] - 0.2*y[49] - 1.5*y[64] - 0.75*y[80] + 1.5*y[82] - 0.5*y[85] - 0.5*y[89] - 1.0*y[97];
    f[81] = -0.5*y[112] + 0.5*y[117] - 0.5*y[16] + 0.2*y[48] - 1.5*y[65] - 0.75*y[81] + 1.5*y[83] + 0.5*y[84] + 0.5*y[88] + 1.0*y[96];
    f[82] = 0.5*y[115] + 0.5*y[118] + 0.5*y[19] - 0.2*y[51] - 1.5*y[66] - 1.5*y[80] - 1.25*y[82] + 1.0*y[85] - 0.5*y[87] + 1.0*y[89] - 0.5*y[91] - 1.0*y[99];
    f[83] = -0.5*y[114] + 0.5*y[119] - 0.5*y[18] + 0.2*y[50] - 1.5*y[67] - 1.5*y[81] - 1.25*y[83] - 1.0*y[84] + 0.5*y[86] - 1.0*y[88] + 0.5*y[90] + 1.0*y[98];
    f[84] = -1.0*y[101] + 0.5*y[117] + 0.5*y[21] - 0.2*y[53] - 1.5*y[68] - 0.5*y[81] + 1.0*y[83] - 1.0*y[84] + 1.5*y[86] + 0.2*y[89] - 0.5*y[93];
    f[85] = 1.0*y[100] - 0.5*y[116] - 0.5*y[20] + 0.2*y[52] - 1.5*y[69] + 0.5*y[80] - 1.0*y[82] - 1.0*y[85] + 1.5*y[87] - 0.2*y[88] + 0.5*y[92];
    f[86] = -1.0*y[103] + 0.5*y[119] + 0.5*y[23] - 0.2*y[55] - 1.5*y[70] - 0.5*y[83] - 1.5*y[84] - 1.5*y[86] + 0.2*y[91] + 1.0*y[93] - 0.5*y[95];
    f[87] = 1.0*y[102] - 0.5*y[118] - 0.5*y[22] + 0.2*y[54] - 1.5*y[71] + 0.5*y[82] - 1.5*y[85] - 1.5*y[87] - 0.2*y[90] - 1.0*y[92] + 0.5*y[94];
    f[88] = -1.0*y[105] + 0.5*y[121] + 0.5*y[124] + 0.5*y[25] - 0.2*y[57] - 1.5*y[72] - 0.5*y[81] + 1.0*y[83] + 0.2*y[85] - 1.0*y[88] + 1.5*y[90] - 0.5*y[93];
    f[89] = 1.0*y[104] - 0.5*y[120] + 0.5*y[125] - 0.5*y[24] + 0.2*y[56] - 1.5*y[73] + 0.5*y[80] - 1.0*y[82] - 0.2*y[84] - 1.0*y[89] + 1.5*y[91] + 0.5*y[92];
    f[90] = -1.0*y[107] + 0.5*y[123] + 0.5*y[126] + 0.5*y[27] - 0.2*y[59] - 1.5*y[74] - 0.5*y[83] + 0.2*y[87] - 1.5*y[88] - 1.5*y[90] + 1.0*y[93] - 0.5*y[95];
    f[91] = 1.0*y[106] - 0.5*y[122] + 0.5*y[127] - 0.5*y[26] + 0.2*y[58] - 1.5*y[75] + 0.5*y[82] - 0.2*y[86] - 1.5*y[89] - 1.5*y[91] - 1.0*y[92] + 0.5*y[94];
    f[92] = -1.0*y[109] + 0.5*y[125] + 0.5*y[29] - 0.2*y[61] - 1.5*y[76] - 0.5*y[85] + 1.0*y[87] - 0.5*y[89] + 1.0*y[91] - 1.25*y[92] + 1.5*y[94];
    f[93] = 1.0*y[108] - 0.5*y[124] - 0.5*y[28] + 0.2*y[60] - 1.5*y[77] + 0.5*y[84] - 1.0*y[86] + 0.5*y[88] - 1.0*y[90] - 1.25*y[93] + 1.5*y[95];
    f[94] = -1.0*y[111] + 0.5*y[127] + 0.5*y[31] - 0.2*y[63] - 1.5*y[78] - 0.5*y[87] - 0.5*y[91] - 1.5*y[92] - 1.75*y[94];
    f[95] = 1.0*y[110] - 0.5*y[126] - 0.5*y[30] + 0.2*y[62] - 1.5*y[79] + 0.5*y[86] + 0.5*y[90] - 1.5*y[93] - 1.75*y[95];
    f[96] = -0.5*y[101] - 0.5*y[105] + 1.5*y[112] + 1.0*y[114] + 0.5*y[33] - 1.0*y[49] + 0.5*y[65] - 1.0*y[81] - 0.5*y[96] + 1.5*y[98];
    f[97] = 0.5*y[100] + 0.5*y[104] + 1.5*y[113] + 1.0*y[115] - 0.5*y[32] + 1.0*y[48] - 0.5*y[64] + 1.0*y[80] - 0.5*y[97] + 1.5*y[99];
    f[98] = 1.0*y[101] - 0.5*y[103] + 1.0*y[105] - 0.5*y[107] + 1.5*y[114] + 0.5*y[35] - 1.0*y[51] + 0.5*y[67] - 1.0*y[83] - 1.5*y[96] - 1.0*y[98];
    f[99] = -1.0*y[100] + 0.5*y[102] - 1.0*y[104] + 0.5*y[106] + 1.5*y[115] - 0.5*y[34] + 1.0*y[50] - 0.5*y[66] + 1.0*y[82] - 1.5*y[97] - 1.0*y[99];
    f[100] = -0.75*y[100] + 1.5*y[102] + 0.2*y[105] - 0.5*y[109] + 1.5*y[116] + 1.0*y[118] + 0.5*y[37] - 1.0*y[53] + 0.5*y[69] - 1.0*y[85] - 0.5*y[97] + 1.0*y[99];
    f[101] = -0.75*y[101] + 1.5*y[103] - 0.2*y[104] + 0.5*y[108] + 1.5*y[117] + 1.0*y[119] - 0.5*y[36] + 1.0*y[52] - 0.5*y[68] + 1.0*y[84] + 0.5*y[96] - 1.0*y[98];
    f[102] = -1.5*y[100] - 1.25*y[102] + 0.2*y[107] + 1.0*y[109] - 0.5*y[111] + 1.5*y[118] + 0.5*y[39] - 1.0*y[55] + 0.5*y[71] - 1.0*y[87] - 0.5*y[99];
    f[103] = -1.5*y[101] - 1.25*y[103] - 0.2*y[106] - 1.0*y[108] + 0.5*y[110] + 1.5*y[119] - 0.5*y[38] + 1.0*y[54] - 0.5*y[70] + 1.0*y[86] + 0.5*y[98];
    f[104] = 0.2*y[101] - 0.75*y[104] + 1.5*y[106] - 0.5*y[109] + 1.5*y[120] + 1.0*y[122] + 0.5*y[41] - 1.0*y[57] + 0.5*y[73] - 1.0*y[89] - 0.5*y[97] + 1.0*y[99];
    f[105] = -0.2*y[100] - 0.75*y[105] + 1.5*y[107] + 0.5*y[108] + 1.5*y[121] + 1.0*y[123] - 0.5*y[40] + 1.0*y[56] - 0.5*y[72] + 1.0*y[88] + 0.5*y[96] - 1.0*y[98];
    f[106] = 0.2*y[103] - 1.5*y[104] - 1.25*y[106] + 1.0*y[109] - 0.5*y[111] + 1.5*y[122] + 0.5*y[43] - 1.0*y[59] + 0.5*y[75] - 1.0*y[91] - 0.5*y[99];
    f[107] = -0.2*y[102] - 1.5*y[105] - 1.25*y[107] - 1.0*y[108] + 0.5*y[110] + 1.5*y[123] - 0.5*y[42] + 1.0*y[58] - 0.5*y[74] + 1.0*y[90] + 0.5*y[98];
    f[108] = -0.5*y[101] + 1.0*y[103] - 0.5*y[105] + 1.0*y[107] - 1.0*y[108] + 1.5*y[110] + 1.5*y[124] + 1.0*y[126] + 0.5*y[45] - 1.0*y[61] + 0.5*y[77] - 1.0*y[93];
    f[109] = 0.5*y[100] - 1.0*y[102] + 0.5*y[104] - 1.0*y[106] - 1.0*y[109] + 1.5*y[111] + 1.5*y[125] + 1.0*y[127] - 0.5*y[44] + 1.0*y[60] - 0.5*y[76] + 1.0*y[92];
    f[110] = -0.5*y[103] - 0.5*y[107] - 1.5*y[108] - 1.5*y[110] + 1.5*y[126] + 0.5*y[47] - 1.0*y[63] + 0.5*y[79] - 1.0*y[95];
    f[111] = 0.5*y[102] + 0.5*y[106] - 1.5*y[109] - 1.5*y[111] + 1.5*y[127] - 0.5*y[46] + 1.0*y[62] - 0.5*y[78] + 1.0*y[94];
    f[112] = -1.0*y[112] + 1.5*y[114] - 0.5*y[117] - 0.5*y[121] + 0.5*y[49] + 0.5*y[81] - 1.5*y[96];
    f[113] = -1.0*y[113] + 1.5*y[115] + 0.5*y[116] + 0.5*y[120] - 0.5*y[48] - 0.5*y[80] - 1.5*y[97];
    f[114] = -1.5*y[112] - 1.5*y[114] + 1.0*y[117] - 0.5*y[119] + 1.0*y[121] - 0.5*y[123] + 0.5*y[51] + 0.5*y[83] - 1.5*y[98];
    f[115] = -1.5*y[113] - 1.5*y[115] - 1.0*y[116] + 0.5*y[118] - 1.0*y[120] + 0.5*y[122] - 0.5*y[50] - 0.5*y[82] - 1.5*y[99];
    f[116] = -1.5*y[100] - 0.5*y[113] + 1.0*y[115] - 1.25*y[116] + 1.5*y[118] + 0.2*y[121] - 0.5*y[125] + 0.5*y[53] + 0.5*y[85];
    f[117] = -1.5*y[101] + 0.5*y[112] - 1.0*y[114] - 1.25*y[117] + 1.5*y[119] - 0.2*y[120] + 0.5*y[124] - 0.5*y[52] - 0.5*y[84];
    f[118] = -1.5*y[102] - 0.5*y[115] - 1.5*y[116] - 1.75*y[118] + 0.2*y[123] + 1.0*y[125] - 0.5*y[127] + 0.5*y[55] + 0.5*y[87];
    f[119] = -1.5*y[103] + 0.5*y[114] - 1.5*y[117] - 1.75*y[119] - 0.2*y[122] - 1.0*y[124] + 0.5*y[126] - 0.5*y[54] - 0.5*y[86];
    f[120] = -1.5*y[104] - 0.5*y[113] + 1.0*y[115] + 0.2*y[117] - 1.25*y[120] + 1.5*y[122] - 0.5*y[125] + 0.5*y[57] + 0.5*y[89];
    f[121] = -1.5*y[105] + 0.5*y[112] - 1.0*y[114] - 0.2*y[116] - 1.25*y[121] + 1.5*y[123] + 0.5*y[124] - 0.5*y[56] - 0.5*y[88];
    f[122] = -1.5*y[106] - 0.5*y[115] + 0.2*y[119] - 1.5*y[120] - 1.75*y[122] + 1.0*y[125] - 0.5*y[127] + 0.5*y[59] + 0.5*y[91];
    f[123] = -1.5*y[107] + 0.5*y[114] - 0.2*y[118] - 1.5*y[121] - 1.75*y[123] - 1.0*y[124] + 0.5*y[126] - 0.5*y[58] - 0.5*y[90];
    f[124] = -1.5*y[108] - 0.5*y[117] + 1.0*y[119] - 0.5*y[121] + 1.0*y[123] - 1.5*y[124] + 1.5*y[126] + 0.5*y[61] + 0.5*y[93];
    f[125] = -1.5*y[109] + 0.5*y[116] - 1.0*y[118] + 0.5*y[120] - 1.0*y[122] - 1.5*y[125] + 1.5*y[127] - 0.5*y[60] - 0.5*y[92];
    f[126] = -1.5*y[110] - 0.5*y[119] - 0.5*y[123] - 1.5*y[124] - 2.0*y[126] + 0.5*y[63] + 0.5*y[95];
    f[127] = -1.5*y[111] + 0.5*y[118] + 0.5*y[122] - 1.5*y[125] - 2.0*y[127] - 0.5*y[62] - 0.5*y[94];
    return GSL_SUCCESS;
}

int dim = 128;

int main(void){
    /*Aqui se colocan los parametros*/ 
    double params = 0; 
    gsl_odeiv2_system sys = {func, NULL, dim, &params};
    gsl_odeiv2_driver *d = gsl_odeiv2_driver_alloc_y_new (&sys, gsl_odeiv2_step_rkf45, 1e-06, 1e-06, 0.0);

    int i;
    double t = 0, t1 = 15;
    double y0[] = { 1.00000000000000, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0, 0.0, 0 };

    hid_t       file_id, dataset_id, dataspace_id;
    hsize_t     dims[2];
    herr_t      status;
    file_id = H5Fcreate(FILENAME, H5F_ACC_TRUNC, H5P_DEFAULT, H5P_DEFAULT);
    dims[0] = 0.015;
    dims[1] = 7;
    dataspace_id = H5Screate_simple(2, dims, NULL);
    dataset_id = H5Dcreate2(file_id, "/dset", H5T_NATIVE_DOUBLE, dataspace_id, H5P_DEFAULT, H5P_DEFAULT, H5P_DEFAULT);

    double complex symbexprs2[] = { y0[0] + I*y0[1] + y0[18] + I*y0[19], y0[36] + I*y0[37] + y0[54] + I*y0[55], y0[72] + I*y0[73] + y0[90] + I*y0[91], y0[108] + I*y0[109] + y0[126] + I*y0[127], y0[126] + I*y0[127] + y0[18] + I*y0[19] + y0[54] + I*y0[55] + y0[90] + I*y0[91], 0.707106781186547*y0[110] + 0.707106781186547*I*y0[111] + 0.707106781186547*y0[124] + 0.707106781186547*I*y0[125] + 0.707106781186547*y0[16] + 0.707106781186547*I*y0[17] + 0.707106781186547*y0[2] + 0.707106781186547*I*y0[3] + 0.707106781186547*y0[38] + 0.707106781186547*I*y0[39] + 0.707106781186547*y0[52] + 0.707106781186547*I*y0[53] + 0.707106781186547*y0[74] + 0.707106781186547*I*y0[75] + 0.707106781186547*y0[88] + 0.707106781186547*I*y0[89], 0.707106781186547*I*(y0[110] + I*y0[111]) - 0.707106781186547*I*(y0[124] + I*y0[125]) - 0.707106781186547*I*(y0[16] + I*y0[17]) + 0.707106781186547*I*(y0[2] + I*y0[3]) + 0.707106781186547*I*(y0[38] + I*y0[39]) - 0.707106781186547*I*(y0[52] + I*y0[53]) + 0.707106781186547*I*(y0[74] + I*y0[75]) - 0.707106781186547*I*(y0[88] + I*y0[89])};

    int j, k;
    double wdata[0.015][7];
    for (k = 0; k < 7; k++){
        wdata[0][k] = creal(symbexprs2[k]);
    }

    double dt = t1 / 0.015;
    for (i = 1; i < 0.015; i++){
        double ti = t + dt;
        int status = gsl_odeiv2_driver_apply (d, &t, ti, y0);
        if (status != GSL_SUCCESS){
            printf ("error, return value=%d\n", status);
            break;
        }
        double complex symbexprs2[] = { y0[0] + I*y0[1] + y0[18] + I*y0[19], y0[36] + I*y0[37] + y0[54] + I*y0[55], y0[72] + I*y0[73] + y0[90] + I*y0[91], y0[108] + I*y0[109] + y0[126] + I*y0[127], y0[126] + I*y0[127] + y0[18] + I*y0[19] + y0[54] + I*y0[55] + y0[90] + I*y0[91], 0.707106781186547*y0[110] + 0.707106781186547*I*y0[111] + 0.707106781186547*y0[124] + 0.707106781186547*I*y0[125] + 0.707106781186547*y0[16] + 0.707106781186547*I*y0[17] + 0.707106781186547*y0[2] + 0.707106781186547*I*y0[3] + 0.707106781186547*y0[38] + 0.707106781186547*I*y0[39] + 0.707106781186547*y0[52] + 0.707106781186547*I*y0[53] + 0.707106781186547*y0[74] + 0.707106781186547*I*y0[75] + 0.707106781186547*y0[88] + 0.707106781186547*I*y0[89], 0.707106781186547*I*(y0[110] + I*y0[111]) - 0.707106781186547*I*(y0[124] + I*y0[125]) - 0.707106781186547*I*(y0[16] + I*y0[17]) + 0.707106781186547*I*(y0[2] + I*y0[3]) + 0.707106781186547*I*(y0[38] + I*y0[39]) - 0.707106781186547*I*(y0[52] + I*y0[53]) + 0.707106781186547*I*(y0[74] + I*y0[75]) - 0.707106781186547*I*(y0[88] + I*y0[89])};

        int n = 7;

        for (j = 0; j< n; j++){
            wdata[i][j] = creal(symbexprs2[j]);
        }
    }
    status = H5Dwrite(dataset_id, H5T_NATIVE_DOUBLE, H5S_ALL, H5S_ALL, H5P_DEFAULT, wdata);
    status = H5Dclose(dataset_id);
    status = H5Sclose(dataspace_id);
    status = H5Fclose(file_id);
    gsl_odeiv2_driver_free (d);
    return 0;
}
